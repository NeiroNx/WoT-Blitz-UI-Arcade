Header:
    version: 120
ImportedPackages:
- "~res:/UI/Screens3/Lobby/Common/BlurDynamic.yaml"
Prototypes:
-   class: "UIControl"
    name: "BLACK2020Tree"
    size: [960.000000, 448.000000]
    input: false
    components:
        SizePolicy:
            horizontalPolicy: "PercentOfParent"
            verticalPolicy: "PercentOfParent"
        UILayoutEventComponent:
            sizeChangedEvent: "SCREEN_SIZE_CHANGED"
            sizeChangedEventData: "_size"
        UIDataParamsComponent:
            params:
            - ["eBlitzDevice", "deviceType", "eBlitzDevice.DEVICE_PHONE", "eBlitzDevice.DEVICE_PHONE"]
            - ["StoryView", "storyView", "null", "{ }"]
            - ["int64", "serverTime", "0L", "1556668800L"]
            - ["bool", "isGfx2", "false", "false"]
            events:
            - "DESELECT"
            - "SHOW_STEP_INFO(int id)"
            - "SELECT_STEP(int id)"
        UIDataLocalVarsComponent:
            data:
            - ["vector2", "screenSize", "vec2(0.000000, 0.000000)"]
            - ["vector<int>", "order3", "[ 10; 4; 9; 11; 8; 12; 5; 6; 7; 1; 2; 3; ]"]
            - ["vector<int>", "order4", "[ 10; 4; 11; 9; 12; 5; 6; 7; 8; 1; 2; 3; ]"]
            - ["int", "stepIndex", "0"]
            - ["int64", "alertTime", "when storyView.story.stage.type == eStageType.PROCESS or storyView.story.stage.type == eStageType.BUY -> 36L * 3600L, 0L"]
            - ["int", "gfx", "when isGfx2 -> 2, 1"]
        UIDataLocalBindingsComponent:
            data:
            - ["vector<int>", "order", "when screenSize.X < 1440 -> order3, order4"]
            - ["StoryStepView", "compositeStep", "when not storyView.tree.compositeSteps.Empty() and storyView.tree.compositeSteps.Contains(\"vehicle\") -> storyView.tree.compositeSteps[\"vehicle\"], null"]
        UIActionComponent:
            actionsPath: "~res:/UI/Screens3/Lobby/Story/BLACK2020/BLACK2020Tree.actions"
        UIEventOnDataComponent0:
            watchedDataExpression: "screenSize"
            eventName: "ON_SCREEN_SIZE_CHANGED"
    children:
    -   class: "UIControl"
        name: "SafeArea"
        input: false
        components:
            Anchor:
                hCenterAnchorEnabled: true
            SizePolicy:
                horizontalPolicy: "Formula"
                horizontalFormula: "parent - safeAreaInsets.left - safeAreaInsets.right"
                verticalPolicy: "PercentOfParent"
        children:
        -   class: "UIControl"
            name: "Content"
            input: false
            components:
                LinearLayout: {}
                SizePolicy:
                    horizontalPolicy: "PercentOfParent"
                    verticalPolicy: "PercentOfParent"
            children:
            -   class: "UIControl"
                name: "LeftArea"
                input: false
                components:
                    SizePolicy:
                        horizontalPolicy: "PercentOfParent"
                        verticalPolicy: "PercentOfParent"
                children:
                -   class: "UIControl"
                    name: "TapArea"
                    components:
                        SizePolicy:
                            horizontalPolicy: "PercentOfParent"
                            verticalPolicy: "PercentOfParent"
                        UIInputEventComponent:
                            onTouchUpInside: "DESELECT"
                -   class: "UIControl"
                    name: "TimerArea"
                    input: false
                    components:
                        Anchor:
                            bottomAnchorEnabled: true
                        SizePolicy:
                            horizontalPolicy: "PercentOfParent"
                            verticalPolicy: "PercentOfParent"
                            verticalValue: 33.333332
                    children:
                    -   class: "UIControl"
                        name: "TimerWrapper"
                        input: false
                        components:
                            Anchor:
                                hCenterAnchorEnabled: true
                                vCenterAnchorEnabled: true
                            LinearLayout:
                                orientation: "TopDown"
                            SizePolicy:
                                horizontalPolicy: "PercentOfMaxChild"
                                verticalPolicy: "PercentOfChildrenSum"
                        children:
                        -   class: "UIControl"
                            name: "Description"
                            input: false
                            classes: "t-body regular white-wild-sand-text"
                            components:
                                UIOpacityComponent:
                                    opacity: 0.650000
                                UITextComponent:
                                    text: "BLACK2020/TimeLeft"
                                Anchor:
                                    hCenterAnchorEnabled: true
                                SizePolicy:
                                    horizontalPolicy: "PercentOfContent"
                                    verticalPolicy: "PercentOfContent"
                                StyleSheet:
                                    styles: "~res:/UI/Screens3/Font.style.yaml"
                        -   class: "UIControl"
                            name: "TimerHolder"
                            input: false
                            components:
                                Anchor:
                                    hCenterAnchorEnabled: true
                                SizePolicy:
                                    horizontalPolicy: "PercentOfFirstChild"
                                    verticalPolicy: "PercentOfFirstChild"
                                UIChildComponent0:
                                    prototypePath: "~res:/UI/Screens3/Lobby/Common/Timer.yaml"
                                    args:
                                        "serverTime": "serverTime"
                                        "time": "storyView.story.finishTime"
                                        "timerSize": "eTimerSize.Big"
                                        "alertTime": "alertTime"
            -   class: "UIControl"
                name: "StepsArea"
                input: false
                components:
                    SizePolicy:
                        horizontalPolicy: "Formula"
                        horizontalFormula: "max(0.5 * parent, lastChild + 4)"
                        verticalPolicy: "PercentOfParent"
                children:
                -   class: "UIControl"
                    name: "MaskedBlur"
                    input: false
                    components:
                        UIPostProcessSourceComponent0:
                            id: "StoryMaskedBlur"
                        IgnoreLayout: {}
                        SizePolicy:
                            horizontalPolicy: "PercentOfParent"
                            verticalPolicy: "PercentOfParent"
                    children:
                    -   prototype: "BlurDynamic/BlurDynamic"
                        name: "BlurDynamic"
                        components:
                            UIPostProcessInputComponent:
                                id: "StoryBackground"
                            UIPostProcessTextureComponent0:
                                needClear: true
                    -   class: "UIControl"
                        name: "Mask"
                        input: false
                        components:
                            Background:
                                usePostProcessedSprite: true
                            UIPostProcessInputComponent:
                                id: "StepMasks"
                            UIPostProcessTextureComponent0:
                                materialPath: "~res:/Materials.custom/2d.Textured.Mask.material"
                                needClear: true
                            SizePolicy:
                                horizontalPolicy: "PercentOfParent"
                                verticalPolicy: "PercentOfParent"
                -   class: "UIControl"
                    name: "BackgroundUnderBlur"
                    input: false
                    components:
                        Background:
                            usePostProcessedSprite: true
                        UIPostProcessInputComponent:
                            id: "StoryBackground"
                        UIPostProcessTextureComponent0:
                            materialPath: "~res:/Materials/2d.Textured.material"
                            needClear: true
                        IgnoreLayout: {}
                        SizePolicy:
                            horizontalPolicy: "PercentOfParent"
                            verticalPolicy: "PercentOfParent"
                -   class: "UIControl"
                    name: "ShowMaskedBlur"
                    input: false
                    components:
                        Background:
                            usePostProcessedSprite: true
                        UIPostProcessInputComponent:
                            id: "StoryMaskedBlur"
                        UIPostProcessTextureComponent0:
                            materialPath: "~res:/Materials/2d.Textured.Alphablend.material"
                            needClear: true
                        SizePolicy:
                            horizontalPolicy: "PercentOfParent"
                            verticalPolicy: "PercentOfParent"
                -   class: "UIControl"
                    name: "StepsHolder"
                    input: false
                    components:
                        Anchor:
                            leftAnchorEnabled: true
                        SizePolicy:
                            horizontalPolicy: "PercentOfFirstChild"
                            verticalPolicy: "PercentOfParent"
                        UIChildComponent0:
                            prototypePath: "~res:/UI/Screens3/Common/VerticalScrollView.yaml"
                            args:
                                "useRightInset": "false"
                                "content": "StepsWrapper"
                                "centerContent": "true"
                                "horizontalPolicy": "eSizePolicy.PercentOfFirstChild"
                                "ltrbClip": "vec4(1.000000, 1.000000, 1.000000, 0.000000)"
                            eventActions:
                            - ["ON_SCROLL_VIEW_TOUCH", "DESELECT", ""]
Slots:
-   class: "UIControl"
    name: "StepsWrapper"
    size: [32.000000, 32.000000]
    input: false
    components:
        SizePolicy:
            horizontalPolicy: "PercentOfLastChild"
            verticalPolicy: "PercentOfLastChild"
    children:
    -   class: "UIControl"
        name: "BlurMask"
        visible: false
        input: false
        components:
            UIPostProcessSourceComponent0:
                id: "StepMasks"
            GridLayout:
                columnWidth: 176.000000
                rowHeight: 214.000000
            SizePolicy:
                horizontalPolicy: "Formula"
                horizontalFormula: "childrenSum + 8"
                verticalPolicy: "PercentOfChildrenSum"
            UIRepeatComponent:
                control: "~res:/UI/Screens3/Lobby/Story/Components/RepeatableBlurMask.yaml"
                dataContainer: "storyView.tree.groups.common.steps"
                args:
                    "stepSize": "when screenSize.X < 1440 -> (when _item.step.id == 9 -> eStepSize.XL, eStepSize.L), (when _item.step.id == 9 or _item.step.id == 2 -> eStepSize.XL, eStepSize.L)"
                    "gridColumn": "when screenSize.X < 1440 -> (when _item.step.id == 4 or _item.step.id == 11 or _item.step.id == 5 or _item.step.id == 1 -> 0, _item.step.id == 9 or _item.step.id == 8 or _item.step.id == 6 or _item.step.id == 2 -> 1, 2), (when _item.step.id == 11 or _item.step.id == 5 or _item.step.id == 1 -> 0, _item.step.id == 9 or _item.step.id == 6 or _item.step.id == 2 -> 1, _item.step.id == 10 or _item.step.id == 7 or _item.step.id == 2 -> 2, 3)"
                    "gridRow": "when screenSize.X < 1440 -> (when _item.step.id == 10 -> 0, _item.step.id == 4 or _item.step.id == 9 -> 1, _item.step.id == 11 or _item.step.id == 8 or _item.step.id == 12 -> 2, _item.step.id == 5 or _item.step.id == 6 or _item.step.id == 7 -> 3, _item.step.id == 1 or _item.step.id == 2 or _item.step.id == 3 -> 4, 5), (when _item.step.id == 10 or _item.step.id == 4 -> 0, _item.step.id == 11 or _item.step.id == 9 or _item.step.id == 12 -> 1, _item.step.id == 5 or _item.step.id == 6 or _item.step.id == 7 or _item.step.id == 8 -> 2, _item.step.id == 1 or _item.step.id == 2 or _item.step.id == 3 -> 3, 0)"
                    "isBlurMask": "true"
        bindings:
        - ["GridLayout.columnCount", "when screenSize.X < 1440 -> 3, 4"]
        - ["GridLayout.rowCount", "when screenSize.X < 1440 -> 5, 4"]
        children:
        -   class: "UIControl"
            name: "CompositeStepBlurMask"
            input: false
            components:
                GridCellComponent: {}
                SizePolicy:
                    horizontalPolicy: "PercentOfFirstChild"
                    verticalPolicy: "PercentOfFirstChild"
                UIChildComponent0:
                    condition: "not storyView.tree.compositeSteps.Empty()"
                    prototypePath: "~res:/UI/Screens3/Lobby/Story/Components/RepeatableBlurMask.yaml"
                    args:
                        "stepSize": "eStepSize.XL"
    -   class: "UIControl"
        name: "Steps"
        input: false
        components:
            GridLayout:
                columnWidth: 176.000000
                rowHeight: 214.000000
            SizePolicy:
                horizontalPolicy: "Formula"
                horizontalFormula: "childrenSum + 8"
                verticalPolicy: "PercentOfChildrenSum"
            UIRepeatComponent:
                control: "~res:/UI/Screens3/Lobby/Story/Components/Repeatable.yaml"
                dataContainer: "storyView.tree.groups.common.steps"
                args:
                    "model": "_item"
                    "stepSize": "when screenSize.X < 1440 -> (when _item.step.id == 9 -> eStepSize.XL, eStepSize.L), (when _item.step.id == 9 or _item.step.id == 2 -> eStepSize.XL, eStepSize.L)"
                    "gridColumn": "when screenSize.X < 1440 -> (when _item.step.id == 4 or _item.step.id == 11 or _item.step.id == 5 or _item.step.id == 1 -> 0, _item.step.id == 9 or _item.step.id == 8 or _item.step.id == 6 or _item.step.id == 2 -> 1, 2), (when _item.step.id == 11 or _item.step.id == 5 or _item.step.id == 1 -> 0, _item.step.id == 9 or _item.step.id == 6 or _item.step.id == 2 -> 1, _item.step.id == 10 or _item.step.id == 7 or _item.step.id == 2 -> 2, 3)"
                    "gridRow": "when screenSize.X < 1440 -> (when _item.step.id == 10 -> 0, _item.step.id == 4 or _item.step.id == 9 -> 1, _item.step.id == 11 or _item.step.id == 8 or _item.step.id == 12 -> 2, _item.step.id == 5 or _item.step.id == 6 or _item.step.id == 7 -> 3, _item.step.id == 1 or _item.step.id == 2 or _item.step.id == 3 -> 4, 5), (when _item.step.id == 10 or _item.step.id == 4 -> 0, _item.step.id == 11 or _item.step.id == 9 or _item.step.id == 12 -> 1, _item.step.id == 5 or _item.step.id == 6 or _item.step.id == 7 or _item.step.id == 8 -> 2, _item.step.id == 1 or _item.step.id == 2 or _item.step.id == 3 -> 3, 0)"
                eventActions:
                - ["DESELECT", "DESELECT", ""]
                - ["SELECT_STEP", "SCROLL_TO_STEP", "_event.id, \"**/Step\" + str(_event.id)"]
                - ["SHOW_STEP_INFO", "SHOW_STEP_INFO", "_event.id"]
                elementNameExpression: "\"Step\" + str(_item.step.id)"
        bindings:
        - ["GridLayout.columnCount", "when screenSize.X < 1440 -> 3, 4"]
        - ["GridLayout.rowCount", "when screenSize.X < 1440 -> 5, 4"]
        children:
        -   class: "UIControl"
            name: "CompositeStep"
            input: false
            components:
                GridCellComponent: {}
                SizePolicy:
                    horizontalPolicy: "PercentOfFirstChild"
                    verticalPolicy: "PercentOfFirstChild"
                UIChildComponent0:
                    condition: "not isNull(compositeStep)"
                    prototypePath: "~res:/UI/Screens3/Lobby/Story/Components/Repeatable.yaml"
                    args:
                        "model": "compositeStep"
                        "stepSize": "eStepSize.XL"
                    eventActions:
                    - ["DESELECT", "DESELECT", ""]
                    - ["SHOW_STEP_INFO", "SHOW_STEP_INFO", "_event.id"]
                    - ["SELECT_STEP", "SCROLL_TO_COMPOSITE_STEP", "\"vehicle\", \"**/CompositeStep\""]
